# Luaの快速ツアー

aoをさらに詳しく探る前に、aoプロセスを操作するための相棒であるLuaの基本を学びましょう。

Luaはシンプルな言語で、驚きはほとんどありません。JavaScriptを知っているなら、簡略化された純粋なバージョンのように感じるでしょう。ゼロから学んでいるなら、重要なことに焦点を当てた小さな言語に感じるでしょう。つまり、明快な構文を持つクリーンな計算です。

このセクションでは、数分でLuaの基本をカバーします。すでにLuaを知っている場合は、[次の章]()に進んでください。

## aosプロセスに再び飛び込む

このチュートリアルでは、[はじめに](/welcome/getting-started)ガイドを既に完了していることを前提とします。まだ完了していない場合は、まずそれを完了してください。

プロセスからログアウトした場合、`aos`をコマンドラインで実行し、オプションで`--wallet [location]`を指定してキー ファイルを指定することで、いつでも再度開くことができます。

## Luaの基本的な式

このプライマーの残りの部分では、Luaのコア機能と構文を素早く説明します。

例を試しながら進めるか、直感的に理解できる場合はスキップしてください。

- **基本的な算術**: `5 + 3`のような基本的な算術を試してください。処理後、結果として`8`が表示されます。`+`、`-`、`*`、`/`、および`^`は期待通りに動作します。`%`はLuaで使用される剰余の記号です。
- **変数の設定**: `a = 10`と入力してエンターを押します。これにより、変数`a`が10に設定されます。慣例として（言語によって強制されるわけではありませんが）、Luaではグローバル変数は大文字で始まります（例：`Handlers`）。

- **変数の使用**: 次に`a * 2`と入力します。コマンドラインに`20`が表示されます。
- **文字列の連結**: `"Hello, " .. ao.id`を実行して、自分に挨拶してみてください。

## 条件文の実験

- **If-Else**: 多くのプログラミング言語と同様に、Luaはif-elseブロックを使用して条件付きでコードを実行します。

  aosプロセスで`.editor`と入力してエンターを押します。これにより、コマンドラインインターフェース内にインラインテキストエディタが開きます。

  ```lua
  aos_coolness = 9001
  if aos_coolness > 9000 then
      return "aosのクール度は9000を超えています！"
  else
      return "ああ。🤷"
  end
  ```

  編集が終わったら、新しい行に`.done`と入力してエンターを押します。これにより編集モードが終了し、式がプロセスに送信されます。

  結果として、aosが9000を超えてクールであることがわかります。良い情報ですね。

  Luaの`if`文には、条件付き実行階層を簡単にする`elseif [condition] then`ブロックを追加することもできます。

## Luaでのループ

Luaには、コードをループするいくつかの方法があります。ここでは、お気に入りの方法を紹介します：

- **Whileループ**:

  カウンタをゼロに初期化するには、`n = 0`と入力してエンターを押します。

  次に再びインラインエディタを`.editor`で開きます。

  ```lua
  while n < 5 do
    n = n + 1
  end
  ```

  新しい行に`.done`と入力してwhileループを実行します。ループの結果を確認するには、単に`n`を実行します。

- **Forループ**:

  LuaはPythonスタイルの`for`ループを特定の値の間で実行することもできます。たとえば、次のコードブロックをエディタに入力します：

  ```lua
  for m = 1, 100 do
          n = n + m
  end
  ```

  再び変数の新しい値を取得するには、`n`を実行します。

## 関数を使う

- **関数を定義する**:

  再びエディタを使って、次の行を送信します：

  ```lua
  function greeting(name)
      return "Hello, " .. name
  end
  ```

  送信後、aosは`undefined`を返します。これは、Luaの関数（および変数）定義が値を返さないためです。

  Luaには「匿名」または「高階」関数もあります。これらは本質的に関数自体を通常のデータとして使用することを可能にし、他の関数への引数として渡すことができます。次の例では、匿名関数を定義し、上記のものと同等です：

  ```lua
  greeting =
  		function(name)
      	return "Hello, " .. name
  		end
  ```

- **関数の呼び出し**: `greeting("Earthling")`を使って関数を呼び出します。aosは`"Hello, Earthling"`を返します。

## テーブルで深いオブジェクトを定義する

テーブルはLuaの唯一の複合データ構造です。`キー`を`値`にマッピングしますが、従来の配列のようにも使用できます。

- **シンプルなテーブルを作成する**: `ao_is = {"hyper", "parallel", "compute"}`と入力してシンプルなテーブルを作成します。
- **テーブルの要素にアクセスする**: `ao_is[2]`で要素にアクセスします。aosは`parallel`を返します。注意：Luaのインデックスは1から始まります！
- **テーブルの要素数をカウントする**: Luaでテーブルのサイズを見つけるには、`#`演算子を使用します。例えば、`#ao_is`を実行すると`3`が返されます。
- **名前付き要素を設定する**: `ao_is["cool"] = true`と入力してテーブルに新しい名前付きキーを追加します。名前付き要素には`.`演算子でもアクセスできます。例えば、`ao_is.cool`です。

## Luaの注意点

aosがLuaを使用する理由は、それがシンプルでクリーンな言語であり、多くの経験豊富なプログラマーが非常に速く学習できるためです。また、Robloxのようなビデオゲームで使用されているため、初めてのプログラミング言語としても人気が高まっています。

それでも、言語には初心者のLuaビルダーを悩ませる傾向があるいくつかの注意点があります。好みは異なるかもしれませんが、ここではLuaの[wat](https://www.destroyallsoftware.com/talks/wat)の包括的なリストを示します：

- **覚えておくべきこと**: テーブルのインデックスは0ではなく1から始まります！
- **覚えておくべきこと**: 'Not equals'は`!=`や類似のものではなく、`~=`で表されます。
- **覚えておくべきこと**: Luaではオブジェクトは'テーブル'と呼ばれ、一般的な名前とは異なります。

## 始めましょう！

これを念頭に置いて、Luaを使って素晴らしい分散プロセスを構築するために必要なすべての知識を得ました！次の章では、Luaとaosを使って並列プロセスを構築し始めます。

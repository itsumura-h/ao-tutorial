# インボックスの理解

aosでは、プロセスはハンドラを介してメッセージに応答して実行されます。未処理のメッセージはプロセスのインボックスに送られます。

## ハンドラとは？

ハンドラは、プロセス内でメッセージを受信して評価する関数です。メッセージをパラメータとして受け取り、それに基づいて動作します。

```lua
function main(Message, ao)
  ...dostuff
  return {
    Output = ...,
    Messages = {},
    Spawns = {}
  }

end
```

`main`関数は、`Output, Messages, and Spawns` または `Error` を提供するluaテーブルを返します。aosでは、ハンドラを使用してプロセスに機能を追加できます。ハンドラは3つのパラメータを取ります：

1. ハンドラの名前
2. マッチャー関数
3. ハンドル関数

```lua
Handlers.add("name",
  function (Msg)
    -- このメッセージが一致するかどうかを判断する（trueまたはfalseを返す）
    return Msg.Action == "Register"
  end,
  function (Msg)
    print("Registered User.")
    table.insert(Members, Msg.From)
    ao.send({Target = Msg.From, Data = "Registered."})
  end
)
```

## インボックスとは？

インボックスは、まだ処理されていないメッセージを格納する領域です。これは、受信したアイテムを処理待ちとして保管する一時的な場所と考えることができます。メッセージが処理されると、それはもはや「受信」アイテムとは見なされず、インボックスから出ます。

> 例: インボックスをあなたのボイスメールのように考えてください。未応答の電話がボイスメールに送られるように、プロセスがすぐに処理しないメッセージはインボックスに送られます。このようにして、未処理のメッセージはあなたが処理する準備ができるまで保管されます。

## まとめ

最初は、すべてのメッセージがインボックスに到達するように見えるかもしれませんが、それらが処理されると消えることがあります。ボイスメールのアナロジーを使うと、応答した電話がボイスメールに行かないように、処理したメッセージはインボックスに現れません。これにより、インボックスとハンドラの役割が明確になります。
